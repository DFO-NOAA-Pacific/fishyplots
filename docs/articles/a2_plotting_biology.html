<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Plotting biology • fishyplots</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting biology">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fishyplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a1_dbi_plots.html">Biomass</a></li>
    <li><a class="dropdown-item" href="../articles/a2_plotting_biology.html">Plotting biology</a></li>
    <li><a class="dropdown-item" href="../articles/a3_fishmap.html">Mapping density</a></li>
    <li><a class="dropdown-item" href="../articles/a4_survey_table.html">Survey information</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plotting biology</h1>
            
      

      <div class="d-none name"><code>a2_plotting_biology.Rmd</code></div>
    </div>

    
    
<p>For these plots we will need biological data stored in three data
frames in the <code>fishyplots</code> package which we can combine with
<code>bind_rows</code> from <code>dplyr</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">fishyplots</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">utils</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nwfsc_bio"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"afsc_bio"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pbs_bio"</span><span class="op">)</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">afsc_bio</span>, <span class="va">nwfsc_bio</span>, <span class="va">pbs_bio</span><span class="op">)</span></span></code></pre></div>
<p>These functions take in any number of subregions (default all
regions) and one lowercase species common or scientific name. Note that
not all species occur in all regions, and “no data” messages or plots
will be displayed. If multiple regions are selected, plots will be
faceted by region by default.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">all_data</span><span class="op">$</span><span class="va">survey</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "AK GULF" "AK BSAI" "NWFSC"   "PBS"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">all_data</span><span class="op">$</span><span class="va">common_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "atka mackerel"       "pacific ocean perch" "southern rock sole" </span></span>
<span><span class="co">#&gt; [4] "northern rockfish"   "flathead sole"       "shortraker rockfish"</span></span></code></pre></div>
<p>Once you have chosen your desired region(s) and species, you can call
the functions. Many biological plotting functions have a few main
arguments to input <code>data</code>, <code>subregions</code>, and
<code>species</code> to be plotted. If available, <code>by_sex</code>
will differentiate data by sex if not done already. Since some species
have limited biological data, some of the facets may display a “no data”
message. If you wish to drop these subplots with missing data, set
<code>facet_all</code> to FALSE.</p>
<div class="section level2">
<h2 id="age-frequency">Age Frequency<a class="anchor" aria-label="anchor" href="#age-frequency"></a>
</h2>
<p>In order to manage the right skew caused by older groundfish, ages
are binned at a certain age percentile. The argument <code>cutoff</code>
can be used to specify the age percentile at which the graph will start
binning (it is automatically set at 0.95). You may also choose to set
<code>by_sex</code> to TRUE if you want to differentiate by sex.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/age_frequency.html">age_frequency</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_data</span>, </span>
<span>              subregions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PBS"</span>, <span class="st">"NWFSC"</span>, <span class="st">"AK BSAI"</span>, <span class="st">"AK GULF"</span><span class="op">)</span>, </span>
<span>              species <span class="op">=</span> <span class="st">"arrowtooth flounder"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_plotting_biology_files/figure-html/plot1-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="length-frequency">Length Frequency<a class="anchor" aria-label="anchor" href="#length-frequency"></a>
</h2>
<p>The following function generates a length frequency plot. If you want
to instead see a histogram of lengths by year you may choose to set the
<code>time_series</code> argument to FALSE (although in doing so you
must subset all_data to the desired regions before calling the
function).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/length_frequency.html">length_frequency</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_data</span>, </span>
<span>                 subregions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PBS"</span>, <span class="st">"NWFSC"</span>, <span class="st">"AK BSAI"</span>, <span class="st">"AK GULF"</span><span class="op">)</span>, </span>
<span>                 species <span class="op">=</span> <span class="st">"arrowtooth flounder"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_plotting_biology_files/figure-html/plot2-1.png" width="1152"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/length_frequency.html">length_frequency</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">nwfsc_bio</span>, </span>
<span>                 subregions <span class="op">=</span> <span class="st">"NWFSC"</span>, </span>
<span>                 species <span class="op">=</span> <span class="st">"arrowtooth flounder"</span>,</span>
<span>                 time_series <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 1 row containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_bin()`).</span></span></code></pre></div>
<p><img src="a2_plotting_biology_files/figure-html/plot2-2.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="average-length">Average Length<a class="anchor" aria-label="anchor" href="#average-length"></a>
</h2>
<p>We also have a function that provides mean length over time
differentiated by sex.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/length_ts.html">length_ts</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_data</span>, </span>
<span>          subregions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PBS"</span>, <span class="st">"NWFSC"</span>, <span class="st">"AK BSAI"</span>, <span class="st">"AK GULF"</span><span class="op">)</span>, </span>
<span>          species <span class="op">=</span> <span class="st">"arrowtooth flounder"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_plotting_biology_files/figure-html/unnamed-chunk-4-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="age---depth">Age - Depth<a class="anchor" aria-label="anchor" href="#age---depth"></a>
</h2>
<p>The next function plots both a histogram and heatmap for the
age-depth relationship. Sex differentiation with <code>by_sex</code>
works best when just looking at one region, although looking at this
across all regions is also an option.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_age_depth.html">plot_age_depth</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_data</span>, </span>
<span>               subregion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AK BSAI"</span>, <span class="st">"AK GULF"</span>, <span class="st">"PBS"</span>, <span class="st">"NWFSC"</span><span class="op">)</span>, </span>
<span>               species <span class="op">=</span> <span class="st">"arrowtooth flounder"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_plotting_biology_files/figure-html/plot3-1.png" width="672"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_age_depth.html">plot_age_depth</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_data</span>,</span>
<span>               subregion <span class="op">=</span> <span class="st">"NWFSC"</span>, </span>
<span>               species <span class="op">=</span> <span class="st">"arrowtooth flounder"</span>,</span>
<span>               by_sex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_plotting_biology_files/figure-html/plot4-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="length---depth">Length - Depth<a class="anchor" aria-label="anchor" href="#length---depth"></a>
</h2>
<p>You can make the same types of graphs for the length-depth
relationship as well. Again, the <code>by_sex</code> argument can be
specified here.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_length_depth.html">plot_length_depth</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_data</span>,</span>
<span>                  subregions <span class="op">=</span> <span class="st">"NWFSC"</span>,</span>
<span>                  species <span class="op">=</span> <span class="st">"sablefish"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_plotting_biology_files/figure-html/plot5-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="growth">Growth<a class="anchor" aria-label="anchor" href="#growth"></a>
</h2>
<p>To make growth plots, this function internally uses prediction data
formulated from the von Bertalanffy function that is stored in the
<code>fishyplots</code> package.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vb_predictions</span><span class="op">)</span></span></code></pre></div>
<p>The function takes in the biological data, the desired region(s), and
1 species. The argument <code>facet_all</code> will automatically
include all subregions regardless of missing data, but can be turned off
when set to FALSE.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_growth.html">plot_growth</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_data</span>,</span>
<span>            subregions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AK BSAI"</span>, <span class="st">"AK GULF"</span>, <span class="st">"NWFSC"</span>, <span class="st">"PBS"</span><span class="op">)</span>,</span>
<span>            species <span class="op">=</span> <span class="st">"arrowtooth flounder"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_plotting_biology_files/figure-html/plot6-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="length---weight">Length - Weight<a class="anchor" aria-label="anchor" href="#length---weight"></a>
</h2>
<p>Finally, we can also plot the length-weight relationship. Similat to
the growth function, this function internally uses log-log regression
prediction data from the <code>fishyplots</code> package.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">lw_predictions</span><span class="op">)</span></span></code></pre></div>
<p>The argument <code>subset</code> defaults TRUE to plot a random
subset of 10000 points per region for quicker plotting speed. To see all
available data points, set as FALSE.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/length_weight.html">length_weight</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_data</span>,</span>
<span>              species <span class="op">=</span> <span class="st">"arrowtooth flounder"</span>,</span>
<span>              subset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: Plotting a random n = 10000 subset of arrowtooth flounder. Model values not impacted.</span></span></code></pre></div>
<p><img src="a2_plotting_biology_files/figure-html/unnamed-chunk-7-1.png" width="1152"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zoe Khan, Callie Murakami.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
